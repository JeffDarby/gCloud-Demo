<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self';
        script-src 'self' 'unsafe-inline' https://apps.mypurecloud.com.au;
        style-src 'self' 'unsafe-inline';
        img-src 'self' https://apps.mypurecloud.com.au;
        connect-src 'self' https://api-cdn.mypurecloud.com.au https://api.mypurecloud.com.au wss://webmessaging.mypurecloud.com.au;
        frame-src 'self' https://apps.mypurecloud.com.au;
    ">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Genesys Cloud Testing</title>
</head>
<body>
    <header>
        <h1>Welcome to the Genesys Cloud Messaging Test page</h1>
    </header>
    <nav>
        <!-- Navigation links go here -->
    </nav>
    <main>
        <button id="startMessenger">Start Messenger</button>
    </main>
    <footer>
        <!-- Footer content goes here -->
    </footer>

    <script type="text/javascript" charset="utf-8">
        function loadGenesysScript() {
            (function (g, e, n, es, ys) {
                g['_genesysJs'] = e;
                g[e] = g[e] || function () {
                    (g[e].q = g[e].q || []).push(arguments)
                };
                g[e].t = 1 * new Date();
                g[e].c = es;
                ys = document.createElement('script');
                ys.async = 1;
                ys.src = n;
                ys.charset = 'utf-8';
                document.head.appendChild(ys);
            })(window, 'Genesys', 'https://apps.mypurecloud.com.au/genesys-bootstrap/genesys.min.js', {
                environment: 'prod-apse2',
                deploymentId: '30e889e3-c65a-49b7-8a2e-69c09e6afa78'
            });
        }

        document.getElementById('startMessenger').addEventListener('click', loadGenesysScript);
        Genesys("subscribe", "Conversations.opened", function() {
    Genesys("command", "MessagingService.fetchHistory", {}, 
        function() {
            // fulfilled callback
            console.log("fulfilled");
        }, 
        function() {
            // rejected callback
            console.log("rejected");
        }
    );
});

    </script>
</body>
</html>
